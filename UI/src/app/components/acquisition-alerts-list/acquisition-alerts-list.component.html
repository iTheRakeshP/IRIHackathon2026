<div class="flex h-full max-h-[85vh] flex-col bg-slate-50">
  <!-- Header -->
  <div class="flex items-start justify-between bg-gradient-to-br from-indigo-500 to-purple-600 px-6 py-5 text-white shadow-lg">
    <div class="flex flex-1 gap-4">
      <div class="flex h-14 w-14 shrink-0 items-center justify-center rounded-xl bg-white/20">
        <mat-icon class="!text-[32px] !w-8 !h-8 text-white">trending_up</mat-icon>
      </div>
      <div>
        <h2 class="mb-1 text-2xl font-semibold !text-white !bg-none !bg-clip-border [-webkit-text-fill-color:white]">Portfolio Growth Opportunities</h2>
        <p class="text-sm text-white/90">Annuity acquisition alerts across all client portfolios</p>
      </div>
    </div>
    <button mat-icon-button (click)="close()" class="!text-white">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <!-- Summary Stats -->
  <div class="flex gap-4 overflow-x-auto border-b-2 border-slate-200 bg-white px-6 py-4">
    <div class="flex min-w-[140px] items-center gap-3 rounded-lg border border-slate-200 bg-slate-50 px-4 py-3">
      <mat-icon class="!text-[28px] !w-7 !h-7 text-indigo-600">people</mat-icon>
      <div>
        <div class="text-xl font-bold text-slate-800">{{ totalClients }}</div>
        <div class="text-[11px] font-semibold uppercase tracking-wider text-slate-400">Clients</div>
      </div>
    </div>
    <div class="flex min-w-[140px] items-center gap-3 rounded-lg border border-slate-200 bg-slate-50 px-4 py-3">
      <mat-icon class="!text-[28px] !w-7 !h-7 text-indigo-600">notifications_active</mat-icon>
      <div>
        <div class="text-xl font-bold text-slate-800">{{ totalAlerts }}</div>
        <div class="text-[11px] font-semibold uppercase tracking-wider text-slate-400">Opportunities</div>
      </div>
    </div>
    <div class="flex min-w-[140px] items-center gap-3 rounded-lg border border-red-200 bg-red-50 px-4 py-3">
      <mat-icon class="!text-[28px] !w-7 !h-7 text-red-500">priority_high</mat-icon>
      <div>
        <div class="text-xl font-bold text-slate-800">{{ getHighPriorityCount() }}</div>
        <div class="text-[11px] font-semibold uppercase tracking-wider text-slate-400">High Priority</div>
      </div>
    </div>
    <div class="flex min-w-[140px] items-center gap-3 rounded-lg border border-amber-200 bg-amber-50 px-4 py-3">
      <mat-icon class="!text-[28px] !w-7 !h-7 text-amber-500">warning</mat-icon>
      <div>
        <div class="text-xl font-bold text-slate-800">{{ getMediumPriorityCount() }}</div>
        <div class="text-[11px] font-semibold uppercase tracking-wider text-slate-400">Medium Priority</div>
      </div>
    </div>
    <div class="flex min-w-[140px] items-center gap-3 rounded-lg border border-green-200 bg-green-50 px-4 py-3">
      <mat-icon class="!text-[28px] !w-7 !h-7 text-green-500">info</mat-icon>
      <div>
        <div class="text-xl font-bold text-slate-800">{{ getLowPriorityCount() }}</div>
        <div class="text-[11px] font-semibold uppercase tracking-wider text-slate-400">Low Priority</div>
      </div>
    </div>
  </div>

  <!-- Alerts Table -->
  <div class="flex-1 overflow-y-auto bg-white">
    <table mat-table [dataSource]="clientAlerts" class="w-full">
      <ng-container matColumnDef="severity">
        <th mat-header-cell *matHeaderCellDef class="!bg-slate-50 !font-semibold !text-slate-700">Priority</th>
        <td mat-cell *matCellDef="let alert">
          <span class="inline-block rounded-full px-2.5 py-0.5 text-[11px] font-bold uppercase tracking-wide"
                [ngClass]="{
                  'bg-red-100 text-red-700': alert.severity === 'HIGH',
                  'bg-amber-100 text-amber-700': alert.severity === 'MEDIUM',
                  'bg-green-100 text-green-700': alert.severity === 'LOW'
                }">
            {{ alert.severity }}
          </span>
        </td>
      </ng-container>

      <ng-container matColumnDef="client">
        <th mat-header-cell *matHeaderCellDef class="!bg-slate-50 !font-semibold !text-slate-700">Client</th>
        <td mat-cell *matCellDef="let alert">
          <div class="font-semibold text-slate-800">{{ alert.clientName }}</div>
          <div class="font-mono text-xs text-slate-400">{{ alert.clientAccountNumber }}</div>
          <div class="text-xs font-semibold text-emerald-600">{{ formatCurrency(alert.totalPortfolioValue) }}</div>
        </td>
      </ng-container>

      <ng-container matColumnDef="type">
        <th mat-header-cell *matHeaderCellDef class="!bg-slate-50 !font-semibold !text-slate-700">Type</th>
        <td mat-cell *matCellDef="let alert">
          <span class="inline-block rounded-full bg-indigo-50 px-3 py-1 text-xs font-semibold text-indigo-600">{{ getAlertTypeLabel(alert.type) }}</span>
        </td>
      </ng-container>

      <ng-container matColumnDef="title">
        <th mat-header-cell *matHeaderCellDef class="!bg-slate-50 !font-semibold !text-slate-700">Opportunity</th>
        <td mat-cell *matCellDef="let alert">
          <div class="max-w-[280px] font-semibold leading-snug text-slate-800">{{ alert.title }}</div>
        </td>
      </ng-container>

      <ng-container matColumnDef="summary">
        <th mat-header-cell *matHeaderCellDef class="!bg-slate-50 !font-semibold !text-slate-700">Summary</th>
        <td mat-cell *matCellDef="let alert">
          <div class="max-w-[320px] text-sm leading-relaxed text-slate-500">{{ alert.reasonShort }}</div>
        </td>
      </ng-container>

      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef class="!bg-slate-50 !font-semibold !text-slate-700">Action</th>
        <td mat-cell *matCellDef="let alert">
          <button (click)="openAlertDetail(alert)"
                  class="inline-flex items-center gap-1.5 rounded-lg bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-700">
            <mat-icon class="!text-[16px] !w-4 !h-4">visibility</mat-icon>
            View Details
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="transition-colors hover:bg-slate-50"></tr>
    </table>

    @if (clientAlerts.length === 0) {
      <div class="flex flex-col items-center justify-center gap-4 py-16 text-slate-300">
        <mat-icon class="!text-[64px] !w-16 !h-16 opacity-50">inbox</mat-icon>
        <p class="text-base text-slate-400">No portfolio opportunities found</p>
      </div>
    }
  </div>

  <!-- Footer -->
  <div class="flex items-center justify-between border-t border-slate-200 bg-white px-6 py-4">
    <div class="flex items-center gap-2 text-sm text-slate-500">
      <mat-icon class="!text-[18px] !w-[18px] !h-[18px] text-indigo-500">info</mat-icon>
      <span>These alerts represent opportunities to grow AUM through new annuity purchases</span>
    </div>
    <button (click)="close()"
            class="rounded-lg bg-indigo-600 px-5 py-2 text-sm font-semibold text-white transition hover:bg-indigo-700">
      Close
    </button>
  </div>
</div>
